# SOLID 设计原则
> SOLID原则的雏形来自Robert C.Martin（Bob大叔）于2000年发表的一篇文章，其中他创造与整理了多条面向对象设计原则。在随后出版的《敏捷软件开发：原则、模式与实践》书中，Bob大叔提取了这些原则的首字母，组成了单词SOLID来帮助记忆。

SOLID单词里的5个字母，分别代表5条设计原则。
* S:single responsibility principle(单一职责原则，SRP)。
* O:open-closed principle(开放-关闭原则，OCP)。
* L:Liskov substitution principle(里式替换原则，LSP)。
* I:interface segregation principle(接口隔离原则，ISP)。
* D:dependency inversion principle(依赖倒置原则，DIP)。

在编写面向对象代码时，遵循这些设计原则可以帮你避开常见的设计陷阱，以便写出易于扩展的好代码。
反之，如果你的代码违反了其中某几条原则，那么你的设计可能有相当大的改进空间。

### 1.单一职责原则
单一职责原则(Single Responsibility Principle)，也称单一责任原则，是指一个类仅有一个被修改的理由。

换句话说：每个类都应该只承担一种职责。

最简单实现方式：
- 创建一个类，只包含一个方法。（大类拆分成小类）

### 2. 开放-关闭原则
开放-关闭原则(Open-Closed Principle)，也称开闭原则，是指对扩展开放，对修改关闭。

换句话说：你可以在不修改某个类的前提下，扩展它的行为。

最简单实现方式：
- 通过继承改造代码
- 使用组合与依赖注入
- 使用数据驱动：将经常变动的部分以数据的方式抽离出来，当需求变化时，只改动数据，代码逻辑可以保持不动。

### 3. 里式替换原则
里式替换原则(Liskov Substitution Principle)，也称里氏替换原则，是指所有引用基类的地方必须能透明地使用其子类的对象。

更通俗的描述是：LSP认为，所有子类（派生类）对象应该可以任意替代父类（基类）对象使用，且不会破坏程序原本的功能。

常见错误实现方式：
- 子类抛出了父类所不认识的异常类型；
- 子类的方法返回值类型与父类不同，并且该类型不是父类返回值类型的子类；
- 子类的方法参数与父类不同，并且参数要求没有变得更宽松（可选参数）、同名参数没有更抽象。

总结：
* LSP认为子类应该可以任意替代父类使用
* 子类不应该抛出父类不认识的异常
* 子类方法应该返回与父类一致的类型，或者返回父类返回值的子类型对象
* 子类的方法参数应该和父类方法完全一致，或者要求更为宽松
* 某些类可能会存在隐式合约，违反这些合约也会导致违反LSP

### 4. 接口隔离原则
接口隔离原则(Interface Segregation Principle)，也称接口隔离原则，是指一个类对另一个类的依赖应该建立在最小的接口上。

总结：
* ISP认为客户依赖的接口不应该包含任何它不需要的方法
* 设计接口就是设计抽象
* 写更小的类、更小的接口在大多数情况下是个好主意

### 5. 依赖倒置原则
依赖倒置原则(Dependency Inversion Principle)，也称依赖倒置原则，是指抽象不应该依赖于细节，细节应该依赖于抽象。

总结：
* DIP认为高层模块和低层模块都应该依赖于抽象
* 编写单元测试有一个原则：测试行为，而不是测试实现
* 单元测试不宜使用太多mock，否则需要调整设计
* 依赖抽象的好处是，修改低层模块实现不会影响高层代码
* 在Python中，你可以用abc模块来定义抽象类
* 除abc以外，你也可以用Protocol等技术来完成依赖倒置